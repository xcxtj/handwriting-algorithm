# http缓存

**强缓存**指的是只要浏览器判断缓存没有过期，则直接使用浏览器的本地缓存

响应头 Cache-Control（相对时间） 和 Expires （绝对时间），**Cache-Control 的优先级高于 Expires** 

浏览器再次请求资源时，会先**通过请求资源的时间与 Cache-Control 中设置的过期时间大小，来计算出该资源是否过期**

**协商缓存**就是与服务端协商之后，通过协商结果来判断是否使用本地缓存。

**只有在未能命中强制缓存的时候，才能发起带有协商缓存字段的请求**。

1 响应头部中的 `Last-Modified`，请求头部中的 `If-Modified-Since`

资源过期了，发现响应头中具有 Last-Modified 声明，则再次发起请求的时候带上 If-Modified-Since设为上次的 Last-Modified 的值的时间，服务器比较资源的最后修改时间

**无法识别一秒内进行多次修改的情况**，某些服务器**不能精确的得到文件最后修改时间**

2请求头部中的 `If-None-Match` 字段与响应头部中的 `ETag`

资源过期再次请求时，会将请求头 If-None-Match 值设置为上一次返回的 **Etag** 的值。服务器收到请求后进行比对本地的资源的 Etag 

**Etag 的优先级更高**

生成 ETag 值时，并*没有统一的算法规则*，而仅仅是由服务器来分配。分布式服务器系统，一模一样的一个文件的Etag值可能不一样。计算**性能损耗**



 **Cache-Control** **值**

| public   | 所有内容都将被缓存(客户端和代理服务器都可缓存)               |
| -------- | ------------------------------------------------------------ |
| private  | 内容只缓存到私有缓存中(仅客户端可以缓存，代理服务器不可缓存) |
| no-cache | 必须先与服务器确认，协商缓存                                 |
| no-store | 所有内容都不会被缓存                                         |



